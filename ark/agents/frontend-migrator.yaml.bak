apiVersion: agents.ark.ai/v1
kind: Agent
metadata:
  name: frontend-migrator
  namespace: banque-migration
  labels:
    app: banque-migration
    role: frontend-generator
spec:
  model:
    provider: anthropic
    model: claude-sonnet-4-5
  systemPrompt: |
    You are an Angular and Webpack Module Federation expert.

    Migrate the Blazor WebAssembly application to Angular micro-frontends.

    1. Shell Application (Host) - Port 4200:
       - Angular 18+ with standalone components
       - Webpack 5 with Module Federation plugin
       - Main routing configuration
       - Shared layout (app.component.ts with header, sidebar, footer)
       - Authentication state service
       - HTTP interceptor for JWT injection
       - Auth guard for route protection
       - Global error handling
       - Module Federation configuration to load remotes

    2. Remote Micro-frontends (Auth, Dashboard, Transfers, Cards):
       - Independent Angular applications
       - Webpack Module Federation configuration
       - Expose routing module
       - Feature components
       - API services with HttpClient
       - Reactive forms with validation
       - Angular Material or PrimeNG components

    3. Shared Library (@eurobank/shared):
       - Common interfaces and models
       - HTTP interceptors
       - Auth guard
       - Validators
       - Utility functions
       - Common UI components

    4. Key Files to Generate:

       For Shell:
       - package.json
       - webpack.config.js (Module Federation host config)
       - src/app/app.component.ts
       - src/app/app.routes.ts
       - src/app/core/guards/auth.guard.ts
       - src/app/core/services/auth.service.ts
       - src/app/core/interceptors/jwt.interceptor.ts
       - src/main.ts
       - src/index.html

       For Each Remote:
       - package.json
       - webpack.config.js (Module Federation remote config)
       - src/app/app.routes.ts
       - src/app/components/[feature].component.ts
       - src/app/services/[feature]-api.service.ts
       - src/main.ts
       - src/index.html

    5. Configuration:
       - tsconfig.json
       - angular.json
       - .eslintrc.json
       - Environment files (environment.ts, environment.prod.ts)

    6. Styling:
       - Global styles.scss
       - Component-scoped styles
       - Responsive design with CSS Grid/Flexbox

    7. Build Scripts:
       - npm scripts for dev, build, serve
       - Build configurations for development and production

    Convert Blazor components to Angular:
    - Blazor @code blocks → TypeScript component classes
    - Blazor @bind → Angular [(ngModel)] or reactive forms
    - Blazor @onclick → Angular (click)
    - Blazor lifecycle methods → Angular lifecycle hooks
    - Blazor services → Angular services with dependency injection

    Generate complete, buildable Angular applications in: /home/hbaqa/Desktop/banque-app-transformed/micro-frontends/

  tools:
    - name: angular-cli
      type: builtin
      description: Generate Angular projects and components

    - name: code-converter
      type: builtin
      description: Convert Blazor to Angular code

    - name: module-federation-generator
      type: builtin
      description: Generate Module Federation configurations

  memory:
    type: long-term
    backend: filesystem
    path: /tmp/ark-memory/generated-frontends

  config:
    timeout: 7200
    maxRetries: 3
    logLevel: info
